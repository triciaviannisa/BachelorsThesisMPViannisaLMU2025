{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"gpuType":"T4","authorship_tag":"ABX9TyO7Z1Kw8Qi4/3J7JxcDBDv0"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"6438983bd9fe4d74af6c8934f5872e7e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ae9135e9b46b4ef09a2ec97315f46c9b","IPY_MODEL_40d8db6664ee40b3a21473da39760b74","IPY_MODEL_3bb5918bbcb545389206b9aebf59d0c3"],"layout":"IPY_MODEL_40b80230d7ad42869595d7dd45b5de01"}},"ae9135e9b46b4ef09a2ec97315f46c9b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_95e9d02485e646e78c116bcffd3e6888","placeholder":"​","style":"IPY_MODEL_51d646534cb1445f9053ecbd8a4ec655","value":"tokenizer_config.json: 100%"}},"40d8db6664ee40b3a21473da39760b74":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_db7e0c23702d493c9c64482a157bb346","max":2,"min":0,"orientation":"horizontal","style":"IPY_MODEL_18bfb30e8e954e6b86adec7dbd8f610c","value":2}},"3bb5918bbcb545389206b9aebf59d0c3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_abe843d389ef42aa8c9ecc7381e96560","placeholder":"​","style":"IPY_MODEL_64c68269eb0f4a0baa7bd506eed55be5","value":" 2.00/2.00 [00:00&lt;00:00, 210B/s]"}},"40b80230d7ad42869595d7dd45b5de01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"95e9d02485e646e78c116bcffd3e6888":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"51d646534cb1445f9053ecbd8a4ec655":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"db7e0c23702d493c9c64482a157bb346":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18bfb30e8e954e6b86adec7dbd8f610c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"abe843d389ef42aa8c9ecc7381e96560":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"64c68269eb0f4a0baa7bd506eed55be5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3e8c28c574254066831774bdc6a85a5b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1f0e11bfa66a49c884939aa5965865ac","IPY_MODEL_ee6cfa5c34654b699c0843108f74813e","IPY_MODEL_bb225caf5df740a6a7ff95302d05c528"],"layout":"IPY_MODEL_46b8e0e90dc64c298cbfa1f675cd17d2"}},"1f0e11bfa66a49c884939aa5965865ac":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_69cbf84e48a347759148906e9c308bea","placeholder":"​","style":"IPY_MODEL_bfb196216cd244b59501855ca0f5d873","value":"vocab.txt: 100%"}},"ee6cfa5c34654b699c0843108f74813e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1714326372594ef0a72db67f2de2c146","max":229167,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cb154abc01c24c858ff00e986dba4d02","value":229167}},"bb225caf5df740a6a7ff95302d05c528":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_604e6795731941798159f2c6d8be5859","placeholder":"​","style":"IPY_MODEL_18814b3caff241f1a267fb6aff23eed9","value":" 229k/229k [00:00&lt;00:00, 1.75MB/s]"}},"46b8e0e90dc64c298cbfa1f675cd17d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"69cbf84e48a347759148906e9c308bea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bfb196216cd244b59501855ca0f5d873":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1714326372594ef0a72db67f2de2c146":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb154abc01c24c858ff00e986dba4d02":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"604e6795731941798159f2c6d8be5859":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18814b3caff241f1a267fb6aff23eed9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b6148fee468b465cadb172da8a2072b8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d1d4f13a77e84b82b661fd7414f0e5b1","IPY_MODEL_6da7776c543a4ebf813757ee615c7b1e","IPY_MODEL_18c7b98117784948a6c2ec972c77c2e1"],"layout":"IPY_MODEL_e4a783bab79a4cba8d9ed9abdd5f853b"}},"d1d4f13a77e84b82b661fd7414f0e5b1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c04cfd3b096b4f799cbd3df59a5f6566","placeholder":"​","style":"IPY_MODEL_8a310a5ad1084063a161a33adc1565dd","value":"special_tokens_map.json: 100%"}},"6da7776c543a4ebf813757ee615c7b1e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_19177dad16ad4b158275b105eadc7ac3","max":112,"min":0,"orientation":"horizontal","style":"IPY_MODEL_194fa16283614c938493d242d8e63c9a","value":112}},"18c7b98117784948a6c2ec972c77c2e1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae7a3893dd48459eb2d1bc957ae7109c","placeholder":"​","style":"IPY_MODEL_f8bbd1c398964dd99428d8ff0a929979","value":" 112/112 [00:00&lt;00:00, 7.26kB/s]"}},"e4a783bab79a4cba8d9ed9abdd5f853b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c04cfd3b096b4f799cbd3df59a5f6566":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8a310a5ad1084063a161a33adc1565dd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"19177dad16ad4b158275b105eadc7ac3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"194fa16283614c938493d242d8e63c9a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ae7a3893dd48459eb2d1bc957ae7109c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f8bbd1c398964dd99428d8ff0a929979":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"590bc2ac2dd4488a9652f93d6908a1f5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e290026885a14423b2490ae5b68948a1","IPY_MODEL_0c311da667af4927ad66769a8d4a89eb","IPY_MODEL_21ca4d522c2946308f820131baa50e94"],"layout":"IPY_MODEL_76fbad8eb2d5447ea3552ae97abfce39"}},"e290026885a14423b2490ae5b68948a1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d0aeb528dab94a14953b8c92fc9dcecd","placeholder":"​","style":"IPY_MODEL_23db716a290542af94762efc210ed9a3","value":"config.json: 100%"}},"0c311da667af4927ad66769a8d4a89eb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_928a02ed76454a599c010e3b2f995708","max":1534,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d028c983b4b64cf59e9e1c9a1ce66740","value":1534}},"21ca4d522c2946308f820131baa50e94":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0045002cf2794cd3843179fda648db74","placeholder":"​","style":"IPY_MODEL_1f256dd1af514e5f8227d9dc4d69d0db","value":" 1.53k/1.53k [00:00&lt;00:00, 178kB/s]"}},"76fbad8eb2d5447ea3552ae97abfce39":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d0aeb528dab94a14953b8c92fc9dcecd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23db716a290542af94762efc210ed9a3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"928a02ed76454a599c010e3b2f995708":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d028c983b4b64cf59e9e1c9a1ce66740":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0045002cf2794cd3843179fda648db74":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1f256dd1af514e5f8227d9dc4d69d0db":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ecaa04d3adb9496f8738834be3557cdb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4586b2d67782409c9aaff6b7cc112b17","IPY_MODEL_1aeda92f87ab4d2599ea3f4cb6ddaee3","IPY_MODEL_cee04c4c83f94cd793872b2665d13102"],"layout":"IPY_MODEL_55e6a06abc174e3f8e09a8b2e2030bd5"}},"4586b2d67782409c9aaff6b7cc112b17":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6fbfa35d4de145c695d0f87d78658025","placeholder":"​","style":"IPY_MODEL_d5f84c0e10a24254af684d8fe549b12a","value":"pytorch_model.bin: 100%"}},"1aeda92f87ab4d2599ea3f4cb6ddaee3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f94d3180c9bc466fa4500d8e9747d77f","max":497810400,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ee087445ae954f4ab2a504a00a4bcf68","value":497810400}},"cee04c4c83f94cd793872b2665d13102":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_18d7c83df2e148b387f424f0b33acc77","placeholder":"​","style":"IPY_MODEL_c1dc220afaaa4671b5592b853bcdcbd1","value":" 498M/498M [00:02&lt;00:00, 246MB/s]"}},"55e6a06abc174e3f8e09a8b2e2030bd5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6fbfa35d4de145c695d0f87d78658025":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d5f84c0e10a24254af684d8fe549b12a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f94d3180c9bc466fa4500d8e9747d77f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ee087445ae954f4ab2a504a00a4bcf68":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"18d7c83df2e148b387f424f0b33acc77":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c1dc220afaaa4671b5592b853bcdcbd1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install fasttext"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fN1HqG0hjl0F","executionInfo":{"status":"ok","timestamp":1746616669312,"user_tz":-120,"elapsed":134643,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"4130c458-c15d-40b0-ca0a-d937360ce312"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting fasttext\n","  Downloading fasttext-0.9.3.tar.gz (73 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/73.4 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m73.4/73.4 kB\u001b[0m \u001b[31m3.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Collecting pybind11>=2.2 (from fasttext)\n","  Using cached pybind11-2.13.6-py3-none-any.whl.metadata (9.5 kB)\n","Requirement already satisfied: setuptools>=0.7.0 in /usr/local/lib/python3.11/dist-packages (from fasttext) (75.2.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from fasttext) (2.0.2)\n","Using cached pybind11-2.13.6-py3-none-any.whl (243 kB)\n","Building wheels for collected packages: fasttext\n","  Building wheel for fasttext (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for fasttext: filename=fasttext-0.9.3-cp311-cp311-linux_x86_64.whl size=4313506 sha256=c0ead6aeee959a434b7752608cfb6007e51b05266786bd025c89fcc16cf71a89\n","  Stored in directory: /root/.cache/pip/wheels/65/4f/35/5057db0249224e9ab55a513fa6b79451473ceb7713017823c3\n","Successfully built fasttext\n","Installing collected packages: pybind11, fasttext\n","Successfully installed fasttext-0.9.3 pybind11-2.13.6\n"]}]},{"cell_type":"code","source":["!git clone https://github.com/IndoNLP/indonlu.git\n","%cd indonlu/"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NWCCJDP3k87O","executionInfo":{"status":"ok","timestamp":1746616674736,"user_tz":-120,"elapsed":1970,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"fff3af3f-3c6d-46f5-95b5-af02cff1fee1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'indonlu'...\n","remote: Enumerating objects: 509, done.\u001b[K\n","remote: Counting objects: 100% (193/193), done.\u001b[K\n","remote: Compressing objects: 100% (83/83), done.\u001b[K\n","remote: Total 509 (delta 119), reused 139 (delta 110), pack-reused 316 (from 1)\u001b[K\n","Receiving objects: 100% (509/509), 9.46 MiB | 16.67 MiB/s, done.\n","Resolving deltas: 100% (239/239), done.\n","/content/indonlu\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vK1w06l8ibvM"},"outputs":[],"source":["import os, sys\n","\n","import random\n","import numpy as np\n","import pandas as pd\n","import torch\n","from torch import optim\n","import torch.nn.functional as F\n","from tqdm import tqdm\n","\n","from transformers import BertForSequenceClassification, BertConfig, BertTokenizer\n","from nltk.tokenize import TweetTokenizer\n","\n","sys.path.append('.')\n","from utils.forward_fn import forward_sequence_classification\n","from utils.metrics import document_sentiment_metrics_fn\n","from utils.data_utils import DocumentSentimentDataset, DocumentSentimentDataLoader"]},{"cell_type":"code","source":["# common functions\n","\n","def set_seed(seed):\n","    random.seed(seed)\n","    np.random.seed(seed)\n","    torch.manual_seed(seed)\n","    torch.cuda.manual_seed(seed)\n","\n","def count_param(module, trainable=False):\n","    if trainable:\n","        return sum(p.numel() for p in module.parameters() if p.requires_grad)\n","    else:\n","        return sum(p.numel() for p in module.parameters())\n","\n","def get_lr(optimizer):\n","    for param_group in optimizer.param_groups:\n","        return param_group['lr']\n","\n","def metrics_to_string(metric_dict):\n","    string_list = []\n","    for key, value in metric_dict.items():\n","        string_list.append('{}:{:.2f}'.format(key, value))\n","    return ' '.join(string_list)"],"metadata":{"id":"6mGvwRJKmC5q"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# set random seed\n","\n","set_seed(26092020)"],"metadata":{"id":"0xI4eAbzmE7j"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# load tokenizer and config\n","\n","tokenizer = BertTokenizer.from_pretrained('indobenchmark/indobert-base-p1')\n","config = BertConfig.from_pretrained('indobenchmark/indobert-base-p1')\n","config.num_labels = DocumentSentimentDataset.NUM_LABELS\n","\n","# instantiate model\n","\n","model = BertForSequenceClassification.from_pretrained('indobenchmark/indobert-base-p1', config=config)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":333,"referenced_widgets":["6438983bd9fe4d74af6c8934f5872e7e","ae9135e9b46b4ef09a2ec97315f46c9b","40d8db6664ee40b3a21473da39760b74","3bb5918bbcb545389206b9aebf59d0c3","40b80230d7ad42869595d7dd45b5de01","95e9d02485e646e78c116bcffd3e6888","51d646534cb1445f9053ecbd8a4ec655","db7e0c23702d493c9c64482a157bb346","18bfb30e8e954e6b86adec7dbd8f610c","abe843d389ef42aa8c9ecc7381e96560","64c68269eb0f4a0baa7bd506eed55be5","3e8c28c574254066831774bdc6a85a5b","1f0e11bfa66a49c884939aa5965865ac","ee6cfa5c34654b699c0843108f74813e","bb225caf5df740a6a7ff95302d05c528","46b8e0e90dc64c298cbfa1f675cd17d2","69cbf84e48a347759148906e9c308bea","bfb196216cd244b59501855ca0f5d873","1714326372594ef0a72db67f2de2c146","cb154abc01c24c858ff00e986dba4d02","604e6795731941798159f2c6d8be5859","18814b3caff241f1a267fb6aff23eed9","b6148fee468b465cadb172da8a2072b8","d1d4f13a77e84b82b661fd7414f0e5b1","6da7776c543a4ebf813757ee615c7b1e","18c7b98117784948a6c2ec972c77c2e1","e4a783bab79a4cba8d9ed9abdd5f853b","c04cfd3b096b4f799cbd3df59a5f6566","8a310a5ad1084063a161a33adc1565dd","19177dad16ad4b158275b105eadc7ac3","194fa16283614c938493d242d8e63c9a","ae7a3893dd48459eb2d1bc957ae7109c","f8bbd1c398964dd99428d8ff0a929979","590bc2ac2dd4488a9652f93d6908a1f5","e290026885a14423b2490ae5b68948a1","0c311da667af4927ad66769a8d4a89eb","21ca4d522c2946308f820131baa50e94","76fbad8eb2d5447ea3552ae97abfce39","d0aeb528dab94a14953b8c92fc9dcecd","23db716a290542af94762efc210ed9a3","928a02ed76454a599c010e3b2f995708","d028c983b4b64cf59e9e1c9a1ce66740","0045002cf2794cd3843179fda648db74","1f256dd1af514e5f8227d9dc4d69d0db","ecaa04d3adb9496f8738834be3557cdb","4586b2d67782409c9aaff6b7cc112b17","1aeda92f87ab4d2599ea3f4cb6ddaee3","cee04c4c83f94cd793872b2665d13102","55e6a06abc174e3f8e09a8b2e2030bd5","6fbfa35d4de145c695d0f87d78658025","d5f84c0e10a24254af684d8fe549b12a","f94d3180c9bc466fa4500d8e9747d77f","ee087445ae954f4ab2a504a00a4bcf68","18d7c83df2e148b387f424f0b33acc77","c1dc220afaaa4671b5592b853bcdcbd1"]},"id":"ZWOBFKW4mHaH","executionInfo":{"status":"ok","timestamp":1746616758709,"user_tz":-120,"elapsed":5734,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"3dc9fdc7-9fa1-4f46-ac31-1867eef8668c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/2.00 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6438983bd9fe4d74af6c8934f5872e7e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/229k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3e8c28c574254066831774bdc6a85a5b"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["special_tokens_map.json:   0%|          | 0.00/112 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6148fee468b465cadb172da8a2072b8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/1.53k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"590bc2ac2dd4488a9652f93d6908a1f5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/498M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ecaa04d3adb9496f8738834be3557cdb"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of BertForSequenceClassification were not initialized from the model checkpoint at indobenchmark/indobert-base-p1 and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"code","source":["train_dataset_path = './dataset/smsa_doc-sentiment-prosa/train_preprocess.tsv'\n","valid_dataset_path = './dataset/smsa_doc-sentiment-prosa/valid_preprocess.tsv'\n","test_dataset_path = './dataset/smsa_doc-sentiment-prosa/test_preprocess_masked_label.tsv'"],"metadata":{"id":"5IGvOjhLmOqB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_dataset = DocumentSentimentDataset(train_dataset_path, tokenizer, lowercase=True)\n","valid_dataset = DocumentSentimentDataset(valid_dataset_path, tokenizer, lowercase=True)\n","test_dataset = DocumentSentimentDataset(test_dataset_path, tokenizer, lowercase=True)\n","\n","train_loader = DocumentSentimentDataLoader(dataset=train_dataset, max_seq_len=512, batch_size=32, num_workers=16, shuffle=True)\n","valid_loader = DocumentSentimentDataLoader(dataset=valid_dataset, max_seq_len=512, batch_size=32, num_workers=16, shuffle=False)\n","test_loader = DocumentSentimentDataLoader(dataset=test_dataset, max_seq_len=512, batch_size=32, num_workers=16, shuffle=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"K-VvVYJemYIf","executionInfo":{"status":"ok","timestamp":1746616763516,"user_tz":-120,"elapsed":105,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"18880d91-e9f1-4dfe-95d0-f69000e7341e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n"]}]},{"cell_type":"code","source":["w2i, i2w = DocumentSentimentDataset.LABEL2INDEX, DocumentSentimentDataset.INDEX2LABEL"],"metadata":{"id":"rbxw1H9FmcZ-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# sentence with positive sentiment, example 1\n","\n","text = \"Aku sangat mencintai dirinya yang sangat sempurna untukku.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Wj_eb6cN6gkY","executionInfo":{"status":"ok","timestamp":1746616768102,"user_tz":-120,"elapsed":259,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"331e8825-16d6-49e5-ac78-97293858b906"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Aku sangat mencintai dirinya yang sangat sempurna untukku. | Label : neutral (38.501%)\n"]}]},{"cell_type":"code","source":["# sentence with positive sentiment, example 2\n","\n","text = \"Dia sangat hebat karena sudah sangat pintar dan mandiri sejak kecil.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Kjv7guNT6q8R","executionInfo":{"status":"ok","timestamp":1746616770135,"user_tz":-120,"elapsed":223,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"40c7e880-a48f-4be8-f2ff-6d8a253d1580"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Dia sangat hebat karena sudah sangat pintar dan mandiri sejak kecil. | Label : neutral (40.196%)\n"]}]},{"cell_type":"code","source":["# sentence with neutral sentiment, example 1\n","\n","text = \"Ayah memakan bubur ayam untuk sarapan tadi pagi.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"NGkHNr9h7Mn9","executionInfo":{"status":"ok","timestamp":1746616771953,"user_tz":-120,"elapsed":145,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"a7eec059-448b-4978-cf34-97cc89829389"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Ayah memakan bubur ayam untuk sarapan tadi pagi. | Label : neutral (42.373%)\n"]}]},{"cell_type":"code","source":["# sentence with neutral sentiment, example 2\n","\n","text = \"Setiap hari, adikku berangkat sekolah pukul 7 pagi.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b0puruGz7RbK","executionInfo":{"status":"ok","timestamp":1746616772942,"user_tz":-120,"elapsed":105,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"7a4eea90-7812-4553-bc74-b515c4ff56fc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Setiap hari, adikku berangkat sekolah pukul 7 pagi. | Label : neutral (38.484%)\n"]}]},{"cell_type":"code","source":["# sentence with negative sentiment, example 1\n","\n","text = \"Temanku sangat benci ibunya yang tidak pernah ada di rumah.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dbmTpbNx7r4c","executionInfo":{"status":"ok","timestamp":1746616774365,"user_tz":-120,"elapsed":109,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"d69c447b-30ff-4ad6-cebf-471f1ccfff42"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Temanku sangat benci ibunya yang tidak pernah ada di rumah. | Label : neutral (39.421%)\n"]}]},{"cell_type":"code","source":["# sentence with negative sentiment, example 2\n","\n","text = \"Budi anak yang sangat malas dan tidak berguna.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ynu679xi7tmi","executionInfo":{"status":"ok","timestamp":1746616776442,"user_tz":-120,"elapsed":185,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"a7753669-8b87-43e2-b8d8-fa2566e77eeb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Budi anak yang sangat malas dan tidak berguna. | Label : neutral (39.066%)\n"]}]},{"cell_type":"code","source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","model = model.to(device)\n","optimizer = optim.Adam(model.parameters(), lr=3e-6)"],"metadata":{"id":"4f-DgSpJmfTQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Train\n","n_epochs = 5\n","for epoch in range(n_epochs):\n","    model.train()\n","    torch.set_grad_enabled(True)\n","\n","    total_train_loss = 0\n","    list_hyp, list_label = [], []\n","\n","    train_pbar = tqdm(train_loader, leave=True, total=len(train_loader))\n","    for i, batch_data in enumerate(train_pbar):\n","        # Forward model\n","        loss, batch_hyp, batch_label = forward_sequence_classification(model, batch_data[:-1], i2w=i2w, device='cuda')\n","\n","        # Update model\n","        optimizer.zero_grad()\n","        loss.backward()\n","        optimizer.step()\n","\n","        tr_loss = loss.item()\n","        total_train_loss += tr_loss\n","\n","        # Calculate metrics\n","        list_hyp += batch_hyp\n","        list_label += batch_label\n","\n","        train_pbar.set_description(\"(Epoch {}) TRAIN LOSS:{:.4f} LR:{:.8f}\".format((epoch+1),\n","            total_train_loss/(i+1), get_lr(optimizer)))\n","\n","    # Calculate train metric\n","    metrics = document_sentiment_metrics_fn(list_hyp, list_label)\n","    print(\"(Epoch {}) TRAIN LOSS:{:.4f} {} LR:{:.8f}\".format((epoch+1),\n","        total_train_loss/(i+1), metrics_to_string(metrics), get_lr(optimizer)))\n","\n","    # Evaluate on validation\n","    model.eval()\n","    torch.set_grad_enabled(False)\n","\n","    total_loss, total_correct, total_labels = 0, 0, 0\n","    list_hyp, list_label = [], []\n","\n","    pbar = tqdm(valid_loader, leave=True, total=len(valid_loader))\n","    for i, batch_data in enumerate(pbar):\n","        batch_seq = batch_data[-1]\n","        loss, batch_hyp, batch_label = forward_sequence_classification(model, batch_data[:-1], i2w=i2w, device='cuda')\n","\n","        # Calculate total loss\n","        valid_loss = loss.item()\n","        total_loss += valid_loss\n","\n","        # Calculate evaluation metrics\n","        list_hyp += batch_hyp\n","        list_label += batch_label\n","        metrics = document_sentiment_metrics_fn(list_hyp, list_label)\n","\n","        pbar.set_description(\"VALID LOSS:{:.4f} {}\".format(total_loss/(i+1), metrics_to_string(metrics)))\n","\n","    metrics = document_sentiment_metrics_fn(list_hyp, list_label)\n","    print(\"(Epoch {}) VALID LOSS:{:.4f} {}\".format((epoch+1),\n","        total_loss/(i+1), metrics_to_string(metrics)))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YMHPRrEQmys0","executionInfo":{"status":"ok","timestamp":1746617606642,"user_tz":-120,"elapsed":827296,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"73bea788-0315-4a5c-8afc-90b0495e7d7a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["(Epoch 1) TRAIN LOSS:0.3349 LR:0.00000300: 100%|██████████| 344/344 [02:34<00:00,  2.22it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 1) TRAIN LOSS:0.3349 ACC:0.88 F1:0.83 REC:0.81 PRE:0.87 LR:0.00000300\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/40 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","VALID LOSS:0.1863 ACC:0.93 F1:0.90 REC:0.89 PRE:0.91: 100%|██████████| 40/40 [00:07<00:00,  5.41it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 1) VALID LOSS:0.1863 ACC:0.93 F1:0.90 REC:0.89 PRE:0.91\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/344 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","(Epoch 2) TRAIN LOSS:0.1579 LR:0.00000300: 100%|██████████| 344/344 [02:38<00:00,  2.17it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 2) TRAIN LOSS:0.1579 ACC:0.94 F1:0.93 REC:0.92 PRE:0.93 LR:0.00000300\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/40 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","VALID LOSS:0.1799 ACC:0.94 F1:0.90 REC:0.89 PRE:0.93: 100%|██████████| 40/40 [00:07<00:00,  5.35it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 2) VALID LOSS:0.1799 ACC:0.94 F1:0.90 REC:0.89 PRE:0.93\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/344 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","(Epoch 3) TRAIN LOSS:0.1195 LR:0.00000300: 100%|██████████| 344/344 [02:38<00:00,  2.17it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 3) TRAIN LOSS:0.1195 ACC:0.96 F1:0.95 REC:0.95 PRE:0.96 LR:0.00000300\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/40 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","VALID LOSS:0.1886 ACC:0.93 F1:0.91 REC:0.91 PRE:0.92: 100%|██████████| 40/40 [00:07<00:00,  5.31it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 3) VALID LOSS:0.1886 ACC:0.93 F1:0.91 REC:0.91 PRE:0.92\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/344 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","(Epoch 4) TRAIN LOSS:0.0929 LR:0.00000300: 100%|██████████| 344/344 [02:38<00:00,  2.18it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 4) TRAIN LOSS:0.0929 ACC:0.97 F1:0.96 REC:0.96 PRE:0.97 LR:0.00000300\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/40 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","VALID LOSS:0.1710 ACC:0.94 F1:0.92 REC:0.91 PRE:0.93: 100%|██████████| 40/40 [00:07<00:00,  5.22it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 4) VALID LOSS:0.1710 ACC:0.94 F1:0.92 REC:0.91 PRE:0.93\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/344 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","(Epoch 5) TRAIN LOSS:0.0657 LR:0.00000300: 100%|██████████| 344/344 [02:38<00:00,  2.17it/s]\n"]},{"output_type":"stream","name":"stdout","text":["(Epoch 5) TRAIN LOSS:0.0657 ACC:0.98 F1:0.97 REC:0.97 PRE:0.98 LR:0.00000300\n"]},{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/40 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","VALID LOSS:0.1771 ACC:0.94 F1:0.92 REC:0.92 PRE:0.92: 100%|██████████| 40/40 [00:07<00:00,  5.23it/s]"]},{"output_type":"stream","name":"stdout","text":["(Epoch 5) VALID LOSS:0.1771 ACC:0.94 F1:0.92 REC:0.92 PRE:0.92\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}]},{"cell_type":"code","source":["# evaluate on test\n","model.eval()\n","torch.set_grad_enabled(False)\n","\n","total_loss, total_correct, total_labels = 0, 0, 0\n","list_hyp, list_label = [], []\n","\n","pbar = tqdm(test_loader, leave=True, total=len(test_loader))\n","for i, batch_data in enumerate(pbar):\n","    _, batch_hyp, _ = forward_sequence_classification(model, batch_data[:-1], i2w=i2w, device='cuda')\n","    list_hyp += batch_hyp\n","\n","# save prediction\n","df = pd.DataFrame({'label':list_hyp}).reset_index()\n","df.to_csv('pred.txt', index=False)\n","\n","print(df)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f4BpqrVOu2fl","executionInfo":{"status":"ok","timestamp":1746617676402,"user_tz":-120,"elapsed":2868,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"df0539d9-d689-4b99-9945-4880763cc81e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["\r  0%|          | 0/16 [00:00<?, ?it/s]/usr/local/lib/python3.11/dist-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.\n","  warnings.warn(\n","100%|██████████| 16/16 [00:02<00:00,  5.79it/s]"]},{"output_type":"stream","name":"stdout","text":["     index     label\n","0        0  negative\n","1        1  negative\n","2        2  negative\n","3        3  negative\n","4        4  negative\n","..     ...       ...\n","495    495   neutral\n","496    496   neutral\n","497    497   neutral\n","498    498  positive\n","499    499  positive\n","\n","[500 rows x 2 columns]\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}]},{"cell_type":"code","source":["# sentence with positive sentiment, example 1\n","\n","text = \"Aku sangat mencintai dirinya yang sangat sempurna untukku.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7ejIgq7t8dau","executionInfo":{"status":"ok","timestamp":1746617729594,"user_tz":-120,"elapsed":484,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"364a2397-a355-4372-d3dc-ae9dd555215b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Aku sangat mencintai dirinya yang sangat sempurna untukku. | Label : positive (99.721%)\n"]}]},{"cell_type":"code","source":["# sentence with positive sentiment, example 2\n","\n","text = \"Dia sangat hebat karena sudah sangat pintar dan mandiri sejak kecil.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oJ4HFuCx8f0N","executionInfo":{"status":"ok","timestamp":1746617731264,"user_tz":-120,"elapsed":82,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"d70925db-d118-4b30-f049-0543711c1916"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Dia sangat hebat karena sudah sangat pintar dan mandiri sejak kecil. | Label : positive (99.805%)\n"]}]},{"cell_type":"code","source":["# sentence with neutral sentiment, example 1\n","\n","text = \"Ayah memakan bubur ayam untuk sarapan tadi pagi.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mluPBbyt8ikd","executionInfo":{"status":"ok","timestamp":1746617733380,"user_tz":-120,"elapsed":388,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"fd5df410-a3e7-49d6-f68f-c106734b157a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Ayah memakan bubur ayam untuk sarapan tadi pagi. | Label : neutral (98.848%)\n"]}]},{"cell_type":"code","source":["# sentence with neutral sentiment, example 2\n","\n","text = \"Setiap hari, adikku berangkat sekolah pukul 7 pagi.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b-PkjZRX8lp_","executionInfo":{"status":"ok","timestamp":1746617734991,"user_tz":-120,"elapsed":420,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"462b3157-6ab0-49a7-edd5-0284ca8434ad"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Setiap hari, adikku berangkat sekolah pukul 7 pagi. | Label : neutral (99.226%)\n"]}]},{"cell_type":"code","source":["# sentence with negative sentiment, example 1\n","\n","text = \"Temanku sangat benci ibunya yang tidak pernah ada di rumah.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"83evbGPk8mCB","executionInfo":{"status":"ok","timestamp":1746617736672,"user_tz":-120,"elapsed":203,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"dde00b33-9c6d-444b-b9e6-cfa7141ae51a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Temanku sangat benci ibunya yang tidak pernah ada di rumah. | Label : negative (99.734%)\n"]}]},{"cell_type":"code","source":["# sentence with negative sentiment, example 2\n","\n","text = \"Budi anak yang sangat malas dan tidak berguna.\"\n","subwords = tokenizer.encode(text)\n","subwords = torch.LongTensor(subwords).view(1, -1).to(model.device)\n","\n","logits = model(subwords)[0]\n","label = torch.topk(logits, k=1, dim=-1)[1].squeeze().item()\n","\n","print(f'Text: {text} | Label : {i2w[label]} ({F.softmax(logits, dim=-1).squeeze()[label] * 100:.3f}%)')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3HHq9Vw58pmt","executionInfo":{"status":"ok","timestamp":1746617737847,"user_tz":-120,"elapsed":123,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"f9f4c6c2-5440-4d50-c528-2938135ca5e1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Text: Budi anak yang sangat malas dan tidak berguna. | Label : negative (99.804%)\n"]}]},{"cell_type":"code","source":["torch.save(model.state_dict(), 'indobert_fine_tuned_model.pth')\n","tokenizer.save_pretrained('./tokenizer')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"N5f7kuKUvBBi","executionInfo":{"status":"ok","timestamp":1746617740589,"user_tz":-120,"elapsed":1701,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"47a4868b-cb8d-478e-b96d-6a8201464b80"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('./tokenizer/tokenizer_config.json',\n"," './tokenizer/special_tokens_map.json',\n"," './tokenizer/vocab.txt',\n"," './tokenizer/added_tokens.json')"]},"metadata":{},"execution_count":25}]},{"cell_type":"code","source":["from google.colab import files\n","\n","import shutil\n","files.download('indobert_fine_tuned_model.pth')\n","shutil.make_archive('tokenizer', 'zip', './tokenizer')\n","files.download('tokenizer.zip')"],"metadata":{"id":"JDWC1Ytwvxa1","executionInfo":{"status":"ok","timestamp":1746617781695,"user_tz":-120,"elapsed":136,"user":{"displayName":"Tricia Viannisa","userId":"05509285508876336804"}},"outputId":"4367bf50-03ad-4778-de68-d9a6d556a48b","colab":{"base_uri":"https://localhost:8080/","height":17}},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_19c5b768-3a7a-46f5-9a4c-3e574493f88b\", \"fine_tuned_model.pth\", 497858069)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_03bf2fce-5e46-489b-96ae-a2476ea71819\", \"tokenizer.zip\", 107862)"]},"metadata":{}}]}]}